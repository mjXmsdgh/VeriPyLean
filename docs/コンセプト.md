# プロジェクトコンセプト：**VeriPyLean**

*~ Human-readable Python, Machine-verifiable Lean 4 ~*

### 1. コンセプト概要

**「AIが書き、数学が査読する」**

`VeriPyLean`は、Pythonの「直感的な書きやすさ」と、Lean 4の「数学的な厳密性」を、共通のAST（抽象構文木）を介して結びつける構造化エディタ/言語基盤です。

* **Python View（フロントエンド）:** 人間およびAIがロジックを直感的に記述・編集するためのインターフェース。
* **Lean 4 View（バックエンド）:** プログラムの数学的妥当性をリアルタイムで表示・検証するためのカーネル。
* **AST-First Design:** コードをテキストではなく「構造化データ」として管理することで、双方向の変換における情報の欠落や矛盾を根本から排除します。

### 2. 解決したい課題

1. **AI生成コードの信頼性向上:** AIが生成したコードに潜むハルシネーション（もっともらしい嘘）を、Lean 4の強力な型システムと証明機能によって、実行前に「数学的な査読」として検知します。
2. **形式手法の民主化:** 専門知識が必要だった「定理証明」を、Pythonという親しみやすい構文の裏側に隠すことで、一般のエンジニアに数学的保証の恩恵を開放します。
3. **不毛なテストの削減:** 境界値テストなどの多くを数学的な安全性の証明に置き換えることで、「テストコードを書く時間を、証明（確信）する時間」へと転換します。

### 3. 検証のコア・ロジック（検証項目）

単なる静的解析を超え、Lean 4のカーネルを用いて以下の項目を数学的に保証します。

* **Safety Guarantees（安全性の保証）:** 0除算、型不一致、配列のインデックス外参照など、実行時例外の原因を静的に排除。
* **Logic Verification（論理検証）:** `if`文などのガード条件が正しく機能しているかを追跡し、論理的な不整合がないかをチェック。
* **Termination Analysis（停止性解析）:** 再帰関数やループが必ず終了することを数学的に証明し、無限ループを未然に防止。

### 4. 技術的アプローチと現状（v0.1）

保存形式をテキストではなくAST管理とすることで、以下のフローを実現しています。

1. **Input:** Python純正の `ast` モジュールを利用し、限定的なPython構文（Subset Python）で記述されたコードを解析。
2. **Transform:** 共通ASTを通じて、Lean 4の項へと「直訳」。
3. **Verify:** Lean 4側で検証を行い、矛盾があればPython側へエラーをフィードバック。
* *実績例:* 四則演算（`+`, `-`, `*`, `//`）の変換、`if-else` 構文の再帰的変換、0除算を防ぐガード条件の検知に成功。



### 5. ロードマップ

* **ASTマッピングの拡充:** リスト操作、再帰関数、ユーザー定義型への対応。
* **Lean 4 Kernelとの完全統合:** 生成コードをバックグラウンドでLean 4へ投げ、証明エラーをPythonユーザーが理解できる言葉でフィードバックするUXの構築。
* **AI証明アシスタント:** Pythonの曖昧な型指定をAIが推論し、Lean側の証明（タクティック）をAIが補完するハイブリッドな開発支援。
